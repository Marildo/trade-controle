<nav>
    <div class="form-group-inline">
        <label for="tipo">Tipo da Nota: </label>
        <select id="tipo" [ngModel]="tipoNota" (ngModelChange)="onSelectTypeNota($event)">
            <option value="-1">Todos</option>
            <option value="1">Acões</option>
            <option value="2">Mercado Futuro</option>
            <option value="0">N/A</option>
        </select>
    </div>
    <div class="form-group-inline">
        <label> Data Referência
            <input type="date" [(ngModel)]="start_referencia"> a <input type="date" [(ngModel)]="end_referencia">
        </label>
    </div>
    <div class="form-group-inline">
        <label> Data processamento:
            <input type="date" [(ngModel)]="start_processamento"> a <input type="date" [(ngModel)]="end_processamento">
        </label>
    </div>
    <button mat-icon-button matTooltip="Filtrar" color="primary" aria-label="Filtrar" (click)="onFilterDates()">
        <mat-icon>filter_alt</mat-icon>
    </button>

    <button mat-button color="primary" matTooltip="Buscar na corretora" (click)="onSearchCorretora()">
        <mat-icon>find_replace</mat-icon>
    </button>

    <button mat-button color="primary" aria-label="Enviar arquivo" matTooltip="Enviar arquivo"
        (click)="hiddenForm=false">
        <mat-icon>file_upload</mat-icon>
    </button>
</nav>
<div class="contener">
    <table>
        <thead>
            <tr>
                <th>Id</th>
                <th>Nome</th>
                <th>Referência</th>
                <th>Data processamento</th>
                <th>Status</th>
                <th>Tipo</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let row of items">
                <td>{{ row.id}}</td>
                <td>{{ row.name}}</td>
                <td>{{ row.data_referencia | date:'dd/MM/yyy'}}</td>
                <td>{{ row.data_processamento | date:'dd/MM/yyy HH:mm:ss'}}</td>
                <td>{{ row.status }} </td>
                <td>{{ row.tipo }}</td>
                <td [hidden]=" row.status == 'Finalizado'">
                    <button mat-icon-button matTooltip="Processar arquivo" color="primary"
                        aria-label="Processar arquivo" (click)="onProcessFile(row.id)">
                        <mat-icon>cloud_sync</mat-icon>
                    </button>
                </td>
                <td [hidden]=" row.status != 'Finalizado'">
                    <button mat-icon-button matTooltip="Reprocessar Nota" color="primary" aria-label="Reporcessar Nota"
                        (click)="onReprocessFile(row.id)">
                        <mat-icon>restart_alt</mat-icon>
                    </button>
                </td>
                <td [hidden]=" row.status != 'Finalizado'">
                    <button mat-icon-button matTooltip="Visualizar Transações" color="primary"
                        aria-label="Visualizar Transações" (click)="onView(row.id)">
                        <mat-icon>preview</mat-icon>
                    </button>
                </td>
                <td>
                    <button mat-icon-button matTooltip="Arquivo PDF" color="primary"
                        aria-label="Arquivo PDF" (click)="onPDF(row.id)">
                        <mat-icon>picture_as_pdf</mat-icon>
                    </button>
                </td>
            </tr>
        </tbody>
    </table>
    <div class="form-up" [hidden]="hiddenForm" (drop)="onDrop($event)" (dragover)="onDragOver($event)">
        <input type="file" (change)="onSelectFile($event)" accept=".pdf" class="form-group" multiple="True" />
        <div class="drop-area">
            <p>Arraste e solte os arquivos aqui</p>
        </div>
        <ul>
            <li *ngFor="let file of selectedFiles">
                {{ file.name }}
            </li>
        </ul>
        <footer class="container-buttons">
            <button mat-raised-button color="accent" (click)="hiddenForm=true">Cancelar</button>
            <button mat-raised-button color="primary" [disabled]="!selectedFiles" (click)="onUploadFile()">Enviar
                arquivo</button>
        </footer>
    </div>
</div>

<app-modal #modal id="modalArquivos">
    <h3 class="title">Status do processamento</h3>
    <table class="table-arquivos">
        <thead>
            <tr>
                <th>Id</th>
                <th>Arquivo</th>
                <th>Status</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let row of uploadedFiles">
                <td>{{ row.id}}</td>
                <td>{{ row.file}}</td>
                <td>{{ row.status}}</td>
                <td>
                    <button mat-icon-button matTooltip="Visualizar Transações" color="primary"
                        aria-label="Visualizar Transações" (click)="onView(row.id)">
                        <mat-icon>preview</mat-icon>
                    </button>
                </td>
            </tr>
        </tbody>
    </table>
    <div class="container-end">
        <button mat-raised-button color="accent" (click)="onCloseModalArquivos()">Fechar</button>
    </div>
</app-modal>